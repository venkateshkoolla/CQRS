CREATE VIEW [dbo].[view_Orders]
    AS
SELECT [Order].[SalesOrderId] AS [Id]
     , [Order].[TotalAmount] AS [TotalAmount]
     , [Order].[TotalTax] AS [TotalTax]
     , [Order].[ocaslr_finaltotal] AS [FinalTotal]
     , [Order].[OrderNumber] AS [OrderNumber]
     , [Order].[ocaslr_federaltax] AS [FederalTax]
     , [Order].[ocaslr_provincialtax] AS [ProvincialTax]
     , [Order].[ocaslr_orderpaymentstatus] AS [OrderPaymentStatus]
     , [Order].[ocaslr_orderprocessingstatus] AS [OrderProcessingStatus]
     , [Order].[ocaslr_paymenttype] AS [OrderPaymentType]
     , [Order].[ocaslr_transactiontype] AS [TransactionType]
     , [Order].[ocaslr_orderconfirmationnumber] AS [OrderConfirmationNumber]
     , [Order].[ocaslr_paymentresponsecode] AS [PaymentResponseCode]
     , [Order].[Ocaslr_note] AS [Note]
     -- Account Balance
     , [Order].[ocaslr_paidtoaccountbalance] AS [AmountPaidToAccountBalance]
     , [Order].[ocaslr_paidfromaccountbalance] AS [AmountPaidFromAccountBalance]
     -- Transfer Balance
     , [Order].[ocaslr_paidfromtransferbalance] AS [AmountPaidFromTransferBalance]
     -- OverPaymentBalance
     , [Order].[ocaslr_paidfromoverpaymentbalance] AS [AmountOverpaymentBalance]
     , [Order].[ocaslr_paidtooverpaymentbalance] AS [AmountPaidToOverpaymentBalance]
     , [Order].[ocaslr_paidfromoverpaymentbalance] AS [AmountPaidFromOverpaymentBalance]
     -- Other balances
     , [Order].[ocaslr_paidagainstnsfbalance] AS [AmountPaidAgainstNsfBalance]
     , [Order].[ocaslr_paidagainstreturnedpaymentbalance] AS [AmountPaidAgainstReturnedPaymentBalance]
     -- Other payments
     , [Order].[ocaslr_paymentamount] AS [PaymentAmount]
     , [Order].[ocaslr_PaidfromVoucher] AS [AmountPaidFromVoucher]
     , [Order].[ocaslr_transactionamount] AS [TransactionAmount]
     , [Order].[ocaslr_paymentdetails] AS [PaymentDetails]
     , [Order].[ocaslr_paymentmethodid] AS [PaymentMethodId]
     , [Order].[CreatedOn] AS [CreatedOn]
     , [Order].[ModifiedOn] AS [ModifiedOn]
     , [Order].[ocaslr_modifiedbyuser] AS [ModifiedBy]
     , [Order].[ocaslr_PaymentSource] AS [SourceId]
     , [Order].[CustomerId] AS [CustomerId]
     , [Application].[ocaslr_applicantid] AS [ApplicantId]
     , [Application].[ocaslr_applicationId] AS [ApplicationId]
     , [Application].[ocaslr_applicationnumber] AS [ApplicationNumber]
     , [ApplicationCycle].[ocaslr_applicationcycleId] AS [ApplicationCycleId]
     , [ApplicationCycle].[ocaslr_applicationcyclestatusid] AS [ApplicationCycleStatusId]
FROM [$(SERVER)].[OCAS_MSCRM].[dbo].[SalesOrderBase] [Order]
    INNER JOIN [$(SERVER)].[OCAS_MSCRM].[dbo].[ocaslr_applicationBase] [Application]
        ON [Order].[ocaslr_applicationid] = [Application].[ocaslr_applicationId] AND [Application].[statecode] = 0
    INNER JOIN [$(SERVER)].[OCAS_MSCRM].[dbo].[ocaslr_applicationcycleBase] [ApplicationCycle]
        ON [Application].[ocaslr_applicationcycleid] = [ApplicationCycle].[ocaslr_applicationcycleId]
WHERE [Order].[StateCode] = 0
