CREATE VIEW [dbo].[view_ProgramChoices]
    AS
SELECT   [ocaslr_programchoiceId] AS [Id]
        ,[ocaslr_applicantid] AS [ApplicantId]
        ,[Choice].[ocaslr_name] AS [Name]
        ,[ocaslr_applicationid] AS [ApplicationId]
        ,[Intake].[Ocaslr_startdate] AS [IntakeStartDate]
        ,[Ocaslr_sequencenumber] AS [SequenceNumber]
        ,[Ocaslr_withdrawalduetoclosure] AS [WithdrawalDueToClosure]
        ,[Ocaslr_withdrawaldate] AS [WithdrawalDate]
        ,[ocaslr_offerstatusid] AS [OfferStatusId]
        ,[Choice].[ocaslr_programintakeid] AS [ProgramIntakeId]
        ,[ocaslr_previousyearattended] AS [PreviousYearAttended]
        ,[Choice].[ocaslr_entrylevelid] AS [EntryLevelId]
        ,[Choice].[ocaslr_previousyearapplied] AS [PreviousYearApplied]
        ,[Choice].[ocaslr_confirmeddate] AS [ConfirmedDate]
        ,[Choice].[ocaslr_effectivedate] AS [EffectiveDate]
        ,[Choice].[ocaslr_sourceid] AS [SourceId]
        ,[Choice].[ocaslr_pathwayid] AS [Pathway]
        ,[Program].[ocaslr_programId] AS [ProgramId]
        ,[Program].[ocaslr_name] AS [ProgramName]
        ,[Program].[ocaslr_programcode] AS [ProgramCode]
        ,[Program].[ocaslr_campusid] AS [CampusId]
        ,CASE
           WHEN [Campus].[ocaslr_brandname] IS NOT NULL AND [Campus].[ocaslr_brandname] <> '' THEN [Campus].[ocaslr_brandname]
           ELSE [Campus].[Name]
         END AS [CampusName]
        ,[Campus].[ocaslr_campuscode] AS [CampusCode]
        ,[CollegeAppCycle].[ocaslr_collegeid] AS [CollegeId]
        ,[College].[Name] AS [CollegeName]
        ,[College].[ocaslr_collegecode] AS [CollegeCode]
        ,[Program].[ocaslr_ProgramDelivery] AS [DeliveryId]
        ,[Choice].[ocaslr_supplementalfeepaid] AS [SupplementalFeePaid]
        ,[Choice].[CreatedOn]
        ,[Choice].[ModifiedOn]
        ,[Choice].[ocaslr_modifiedbyuser] AS [ModifiedBy]
        ,[Choice].[statecode]
FROM [$(SERVER)].[OCAS_MSCRM].[dbo].[ocaslr_programchoiceBase] AS [Choice]
    INNER JOIN [$(SERVER)].[OCAS_MSCRM].[dbo].[ocaslr_programintakeBase] AS [Intake]
        ON [Intake].[ocaslr_programintakeId] = [Choice].[ocaslr_programintakeid]
    INNER JOIN [$(SERVER)].[OCAS_MSCRM].[dbo].[ocaslr_programBase] AS [Program]
        ON [Intake].[ocaslr_programid] = [Program].[ocaslr_programId]
    INNER JOIN [$(SERVER)].[OCAS_MSCRM].[dbo].[AccountBase] AS [Campus]
        ON [Campus].[AccountId] = [Program].[ocaslr_campusid]
    INNER JOIN [$(SERVER)].[OCAS_MSCRM].[dbo].[ocaslr_collegeapplicationcycleBase] AS [CollegeAppCycle]
        ON [CollegeAppCycle].[ocaslr_collegeapplicationcycleId] = [Program].[ocaslr_collegeapplicationcycleid]
    INNER JOIN [$(SERVER)].[OCAS_MSCRM].[dbo].[AccountBase] AS [College]
        ON [CollegeAppCycle].[ocaslr_collegeid] = [College].[AccountId]
    INNER JOIN [$(SERVER)].[OCAS_MSCRM].[dbo].[ocaslr_applicationcycleBase] [ApplicationCycle]
        ON [CollegeAppCycle].[ocaslr_applicationcycleid] = [ApplicationCycle].[ocaslr_applicationcycleId]
    INNER JOIN [$(SERVER)].[OCAS_MSCRM].[dbo].[ocaslr_applicationcyclestatusBase] [ApplicationCycleStatus]
        ON [ApplicationCycleStatus].[ocaslr_applicationcyclestatusId] = [ApplicationCycle].[ocaslr_applicationcyclestatusid]
WHERE [ApplicationCycleStatus].[ocaslr_code] = 'A'
